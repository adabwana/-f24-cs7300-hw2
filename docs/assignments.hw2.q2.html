<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Homework 1 - Question 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assignments.hw2.q3.html" rel="next">
<link href="./assignments.hw2.q1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="icon" href="data:,">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./assignments.hw2.q2.html"><span class="chapter-title">Question 2</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Homework 1</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Jaryt Salvo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignments.hw2.q1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Question 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignments.hw2.q2.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Question 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignments.hw2.q3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Question 3</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#k-fold-cross-validation-procedure" id="toc-k-fold-cross-validation-procedure" class="nav-link active" data-scroll-target="#k-fold-cross-validation-procedure">K-fold Cross Validation Procedure:</a></li>
  <li><a href="#explanation-of-feature-importances" id="toc-explanation-of-feature-importances" class="nav-link" data-scroll-target="#explanation-of-feature-importances">Explanation of feature importances:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Question 2</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<style></style>
<style>.printedClojure .sourceCode {
  background-color: transparent;
  border-style: none;
}
</style>
<style>.clay-limit-image-width .clay-image {max-width: 100%}
.clay-side-by-side .sourceCode {margin: 0}
.clay-side-by-side {margin: 1em 0}
</style>
<script src="assignments.hw2.q2_files/md-default1.js" type="text/javascript"></script>
<script src="assignments.hw2.q2_files/md-default2.js" type="text/javascript"></script>
<script src="assignments.hw2.q2_files/vega3.js" type="text/javascript"></script>
<script src="assignments.hw2.q2_files/vega4.js" type="text/javascript"></script>
<script src="assignments.hw2.q2_files/vega5.js" type="text/javascript"></script>
<div class="sourceClojure">
<div class="sourceCode" id="cb1"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">ns</span> assignments.hw2.q2</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  (<span class="at">:require</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>   [assignments.hw2.utils <span class="at">:refer</span> <span class="at">:all</span>]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="co">;; [scicloj.sklearn-clj]</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   [scicloj.hanamicloth.v1.api <span class="at">:as</span> haclo]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   [libpython-clj2.python <span class="at">:refer</span> [py. py.<span class="kw">-</span>]]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>   [libpython-clj2.<span class="kw">require</span> <span class="at">:refer</span> [require-python]]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   [my-py-clj.config <span class="at">:refer</span> <span class="at">:all</span>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>   [tablecloth.api <span class="at">:as</span> tc]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>   [scicloj.kindly.v4.kind <span class="at">:as</span> kind]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="q2-cross-validation-for-ridge-regression-40-points" class="level4">
<h4 class="anchored" data-anchor-id="q2-cross-validation-for-ridge-regression-40-points"><em>Q2: Cross Validation for Ridge Regression (40 points)</em></h4>
<p>For this question, you will need to perform Ridge (<span class="math inline">\(L^2\)</span>) regression with K-fold cross validation via Scki-Learn. The data set is the famous Boston Housing data, which is a benchmark data for regression. The data contains 14 attributes and the <code>medv</code>, median value of owner-occupied homes in $1000s, will be your target to predict. The data set can be downloaded from canvas. You can also find some helpful information at <a href="https://www.kaggle.com/code/henriqueyamahata/boston-housing-with-linear-regression/notebook">Kaggle</a>.</p>
<p>In lecture, we learned training, test, and validation. However, in the real-world, we cannot always afford to implement it due to insufficient data. An alternative solution is K-fold cross validation which uses a part of the available data to fit the model, and a different part to test it. K-fold CV procedure splits the data into K equal-sized parts.</p>
<p><strong><em>1) Load the train data and test data</em></strong></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb2"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(require-python '[numpy <span class="at">:as</span> np])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb3"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="at">:ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb4"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(require-python '[pandas <span class="at">:as</span> pd])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb5"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="at">:ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb6"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(require-python '[sklearn.model_selection <span class="at">:as</span> model-selection])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb7"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="at">:ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb8"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(require-python '[sklearn.linear_model <span class="at">:as</span> linear-model])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb9"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="at">:ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb10"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(require-python '[sklearn.metrics <span class="at">:as</span> metrics])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb11"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="at">:ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These lines import necessary Python libraries for data manipulation, model selection, and evaluation. I wish I hide the <code>:ok</code> code-outputs, alas, I haven’t found that option yet.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb12"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> train-data </span>(pd/read_csv <span class="st">"data/A1Q2_Train_Data.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb13"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> test-data </span>(pd/read_csv <span class="st">"data/A1Q2_Test_Data.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we load the training and test datasets from CSV files using pandas.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb14"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(pd/DataFrame train-data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb15"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>      ID     crim    zn  indus  chas  ...  tax  ptratio   black  lstat  medv</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="dv">1</span>  <span class="fl">0.00632</span>  <span class="fl">18.0</span>   <span class="fl">2.31</span>     <span class="dv">0</span>  ...  <span class="dv">296</span>     <span class="fl">15.3</span>  <span class="fl">396.90</span>   <span class="fl">4.98</span>  <span class="fl">24.0</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">2</span>  <span class="fl">0.02731</span>   <span class="fl">0.0</span>   <span class="fl">7.07</span>     <span class="dv">0</span>  ...  <span class="dv">242</span>     <span class="fl">17.8</span>  <span class="fl">396.90</span>   <span class="fl">9.14</span>  <span class="fl">21.6</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">4</span>  <span class="fl">0.03237</span>   <span class="fl">0.0</span>   <span class="fl">2.18</span>     <span class="dv">0</span>  ...  <span class="dv">222</span>     <span class="fl">18.7</span>  <span class="fl">394.63</span>   <span class="fl">2.94</span>  <span class="fl">33.4</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">5</span>  <span class="fl">0.06905</span>   <span class="fl">0.0</span>   <span class="fl">2.18</span>     <span class="dv">0</span>  ...  <span class="dv">222</span>     <span class="fl">18.7</span>  <span class="fl">396.90</span>   <span class="fl">5.33</span>  <span class="fl">36.2</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">7</span>  <span class="fl">0.08829</span>  <span class="fl">12.5</span>   <span class="fl">7.87</span>     <span class="dv">0</span>  ...  <span class="dv">311</span>     <span class="fl">15.2</span>  <span class="fl">395.60</span>  <span class="fl">12.43</span>  <span class="fl">22.9</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>..   ...      ...   ...    ...   ...  ...  ...      ...     ...    ...   ...</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="dv">328</span>  <span class="dv">500</span>  <span class="fl">0.17783</span>   <span class="fl">0.0</span>   <span class="fl">9.69</span>     <span class="dv">0</span>  ...  <span class="dv">391</span>     <span class="fl">19.2</span>  <span class="fl">395.77</span>  <span class="fl">15.10</span>  <span class="fl">17.5</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="dv">329</span>  <span class="dv">502</span>  <span class="fl">0.06263</span>   <span class="fl">0.0</span>  <span class="fl">11.93</span>     <span class="dv">0</span>  ...  <span class="dv">273</span>     <span class="fl">21.0</span>  <span class="fl">391.99</span>   <span class="fl">9.67</span>  <span class="fl">22.4</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="dv">330</span>  <span class="dv">503</span>  <span class="fl">0.04527</span>   <span class="fl">0.0</span>  <span class="fl">11.93</span>     <span class="dv">0</span>  ...  <span class="dv">273</span>     <span class="fl">21.0</span>  <span class="fl">396.90</span>   <span class="fl">9.08</span>  <span class="fl">20.6</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="dv">331</span>  <span class="dv">504</span>  <span class="fl">0.06076</span>   <span class="fl">0.0</span>  <span class="fl">11.93</span>     <span class="dv">0</span>  ...  <span class="dv">273</span>     <span class="fl">21.0</span>  <span class="fl">396.90</span>   <span class="fl">5.64</span>  <span class="fl">23.9</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="dv">332</span>  <span class="dv">506</span>  <span class="fl">0.04741</span>   <span class="fl">0.0</span>  <span class="fl">11.93</span>     <span class="dv">0</span>  ...  <span class="dv">273</span>     <span class="fl">21.0</span>  <span class="fl">396.90</span>   <span class="fl">7.88</span>  <span class="fl">11.9</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">333</span> rows x <span class="dv">15</span> columns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb16"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(pd/DataFrame test-data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb17"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>      ID     crim    zn  indus  chas  ...  rad  tax  ptratio   black  lstat</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="dv">3</span>  <span class="fl">0.02729</span>   <span class="fl">0.0</span>   <span class="fl">7.07</span>     <span class="dv">0</span>  ...    <span class="dv">2</span>  <span class="dv">242</span>     <span class="fl">17.8</span>  <span class="fl">392.83</span>   <span class="fl">4.03</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">6</span>  <span class="fl">0.02985</span>   <span class="fl">0.0</span>   <span class="fl">2.18</span>     <span class="dv">0</span>  ...    <span class="dv">3</span>  <span class="dv">222</span>     <span class="fl">18.7</span>  <span class="fl">394.12</span>   <span class="fl">5.21</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">8</span>  <span class="fl">0.14455</span>  <span class="fl">12.5</span>   <span class="fl">7.87</span>     <span class="dv">0</span>  ...    <span class="dv">5</span>  <span class="dv">311</span>     <span class="fl">15.2</span>  <span class="fl">396.90</span>  <span class="fl">19.15</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">9</span>  <span class="fl">0.21124</span>  <span class="fl">12.5</span>   <span class="fl">7.87</span>     <span class="dv">0</span>  ...    <span class="dv">5</span>  <span class="dv">311</span>     <span class="fl">15.2</span>  <span class="fl">386.63</span>  <span class="fl">29.93</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     <span class="dv">10</span>  <span class="fl">0.17004</span>  <span class="fl">12.5</span>   <span class="fl">7.87</span>     <span class="dv">0</span>  ...    <span class="dv">5</span>  <span class="dv">311</span>     <span class="fl">15.2</span>  <span class="fl">386.71</span>  <span class="fl">17.10</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>..   ...      ...   ...    ...   ...  ...  ...  ...      ...     ...    ...</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="dv">168</span>  <span class="dv">496</span>  <span class="fl">0.17899</span>   <span class="fl">0.0</span>   <span class="fl">9.69</span>     <span class="dv">0</span>  ...    <span class="dv">6</span>  <span class="dv">391</span>     <span class="fl">19.2</span>  <span class="fl">393.29</span>  <span class="fl">17.60</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="dv">169</span>  <span class="dv">497</span>  <span class="fl">0.28960</span>   <span class="fl">0.0</span>   <span class="fl">9.69</span>     <span class="dv">0</span>  ...    <span class="dv">6</span>  <span class="dv">391</span>     <span class="fl">19.2</span>  <span class="fl">396.90</span>  <span class="fl">21.14</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="dv">170</span>  <span class="dv">499</span>  <span class="fl">0.23912</span>   <span class="fl">0.0</span>   <span class="fl">9.69</span>     <span class="dv">0</span>  ...    <span class="dv">6</span>  <span class="dv">391</span>     <span class="fl">19.2</span>  <span class="fl">396.90</span>  <span class="fl">12.92</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="dv">171</span>  <span class="dv">501</span>  <span class="fl">0.22438</span>   <span class="fl">0.0</span>   <span class="fl">9.69</span>     <span class="dv">0</span>  ...    <span class="dv">6</span>  <span class="dv">391</span>     <span class="fl">19.2</span>  <span class="fl">396.90</span>  <span class="fl">14.33</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="dv">172</span>  <span class="dv">505</span>  <span class="fl">0.10959</span>   <span class="fl">0.0</span>  <span class="fl">11.93</span>     <span class="dv">0</span>  ...    <span class="dv">1</span>  <span class="dv">273</span>     <span class="fl">21.0</span>  <span class="fl">393.45</span>   <span class="fl">6.48</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">173</span> rows x <span class="dv">14</span> columns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Inspect the loaded datasets as pandas DataFrames.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb18"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> X-train </span>(py. train-data <span class="kw">drop</span> <span class="st">"medv"</span> <span class="at">:axis</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb19"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> y-train </span>(py. train-data <span class="st">"get"</span> <span class="st">"medv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We separate the features (X-train) and target variable (y-train) from the training data.</p>
<p><strong><em>2) Perform Ridge regression on the train data</em></strong></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb20"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> ridge-model </span>(linear-model/Ridge))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb21"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> param-grid </span>{<span class="st">"alpha"</span> [<span class="dv">150</span> <span class="dv">160</span> <span class="dv">165</span> <span class="dv">170</span> <span class="dv">175</span> <span class="dv">180</span> <span class="dv">185</span> <span class="dv">190</span> <span class="dv">195</span> <span class="dv">200</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb22"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> cv-ridge </span>(model-selection/GridSearchCV ridge-model param-grid <span class="at">:cv</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we set up the Ridge regression model and define a parameter grid for alpha values. We then create a GridSearchCV object for 5-fold cross-validation.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb23"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(py. cv-ridge fit X-train y-train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb24"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>GridSearchCV(cv=<span class="dv">5</span>, estimator=Ridge(),</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>             param_grid={<span class="at">'alpha':</span> [<span class="dv">150</span>, <span class="dv">160</span>, <span class="dv">165</span>, <span class="dv">170</span>, <span class="dv">175</span>, <span class="dv">180</span>, <span class="dv">185</span>, <span class="dv">190</span>, <span class="dv">195</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">200</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This line fits the Ridge regression model using GridSearchCV on the training data.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb25"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(answer (<span class="kw">str</span> <span class="st">"Best parameters:"</span> (py.<span class="kw">-</span> cv-ridge best_params_)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><span style="color: black; font-size: 1.5em;"><strong>Best parameters:{‘alpha’: 180}</strong></span></p>
</blockquote>
<div class="sourceClojure">
<div class="sourceCode" id="cb26"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(answer (<span class="kw">str</span> <span class="st">"Best CV score:"</span> (py.<span class="kw">-</span> cv-ridge best_score_)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><span style="color: black; font-size: 1.5em;"><strong>Best CV score:0.17820256573782292</strong></span></p>
</blockquote>
</section>
<section id="k-fold-cross-validation-procedure" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cross-validation-procedure">K-fold Cross Validation Procedure:</h3>
<ol type="1">
<li><p>The training data is divided into 5 equal parts (folds).</p></li>
<li><p>For each fold:</p>
<ol type="a">
<li>That fold is treated as a validation set.</li>
<li>The model is trained on the remaining 4 folds.</li>
<li>The model’s performance is evaluated on the validation fold.</li>
</ol></li>
<li><p>This process is repeated 5 times, with each fold serving as the validation set once.</p></li>
<li><p>The average performance across all 5 validations is used as the cross-validation score.</p></li>
<li><p>This entire procedure is repeated for each hyperparameter combination (different alpha values).</p></li>
<li><p>The hyperparameters that yield the best average performance are selected.</p></li>
</ol>
<p>This method provides a robust estimate of the model’s performance and helps in selecting the best hyperparameters, reducing the risk of overfitting.</p>
<p>Below, we print the best model’s intercept and coefficients, and construct a human-readable equation for the Ridge regression model.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb27"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [best-model (py.<span class="kw">-</span> cv-ridge best_estimator_)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>      intercept (py.<span class="kw">-</span> best-model intercept_)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>      coefficients (py.<span class="kw">-</span> best-model coef_)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>      feature-names (py.<span class="kw">-</span> X-train columns)]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  (answer</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>   (<span class="kw">str</span> <span class="st">"Ridge Regression Equation:</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$medv = "</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">format</span> <span class="st">"%.4f"</span> intercept)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">apply</span> <span class="kw">str</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>               (<span class="kw">map</span> (<span class="kw">fn</span> [<span class="kw">name</span> coef]</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                      (<span class="kw">format</span> <span class="st">" %s %.4f * %s"</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>                              (<span class="kw">if</span> (<span class="kw">pos?</span> coef) <span class="st">"+"</span> <span class="st">"-"</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                              (Math/abs coef)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>                              <span class="kw">name</span>))</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                    feature-names</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                    coefficients)) <span class="st">"$"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><span style="color: black; font-size: 1.5em;"><strong>Ridge Regression Equation: <span class="math inline">\(medv = 39.8963 - 0.0023 * ID - 0.0490 * crim + 0.0578 * zn + 0.0043 * indus + 0.3847 * chas - 0.0680 * nox + 1.3832 * rm + 0.0129 * age - 0.9845 * dis + 0.3697 * rad - 0.0167 * tax - 0.7580 * ptratio + 0.0116 * black - 0.7889 * lstat\)</span></strong></span></p>
</blockquote>
<p><strong><em>3) Justify the choice of K</em></strong></p>
<p>We chose <span class="math inline">\(K=5\)</span> for cross-validation as it provides a good balance between bias and variance. It’s a common choice that works well for most datasets, offering reliable performance estimates without excessive computational cost.</p>
<p><strong><em>4) Test the model on the test data</em></strong></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb28"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> best-ridge-model </span>(py.<span class="kw">-</span> cv-ridge best_estimator_))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we extract the best Ridge regression model from the GridSearchCV results.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb29"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> y-pred </span>(py. best-ridge-model predict test-data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>y-pred</code> is the predictions on the entire test dataset using the best Ridge regression model.</p>
<p><strong><em>5) Analyze the importance of each feature and justify your results in the report</em></strong></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb30"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> feature-importance </span>(py.<span class="kw">-</span> best-ridge-model coef_))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb31"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> feature-names </span>(py.<span class="kw">-</span> X-train columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These lines extract the feature coefficients (which represent feature importance in linear models) and feature names from the best model and training data, respectively.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb32"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [feature-names (<span class="kw">vec</span> feature-names)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>      feature-importance (<span class="kw">vec</span> feature-importance)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>      data (tc/dataset {<span class="at">:vars</span> feature-names</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:importance</span> feature-importance})</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>      sorted (tc/order-by data <span class="at">:importance</span> <span class="at">:desc</span>)]</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> sorted</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>      (haclo/layer-bar</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>       {:=y <span class="at">:vars</span> :=x <span class="at">:importance</span>       <span class="co">;order-by??</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        :=title <span class="st">"Feature Importances"</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div><script>vegaEmbed(document.currentScript.parentElement, {"encoding":{"x":{"field":"x","type":"nominal"},"y":{"field":"y","type":"nominal"}},"usermeta":{"embedOptions":{"renderer":"svg"}},"width":400,"background":"floralwhite","layer":[{"mark":{"type":"bar","tooltip":true},"encoding":{"x":{"field":"importance","type":"quantitative"},"y":{"field":"vars","type":"nominal"}},"data":{"values":"vars,importance\nrm,1.3832310453542689\nchas,0.3846674322920127\nrad,0.3697238002007228\nzn,0.05778196417719924\nage,0.012925702145975593\nblack,0.011621283571712876\nindus,0.004296184605311984\nID,-0.002269139274071281\ntax,-0.016673829625451803\ncrim,-0.049041726989618964\nnox,-0.06800806864610484\nptratio,-0.7579591504170874\nlstat,-0.7888725000106315\ndis,-0.984478760041314\n","format":{"type":"csv"}}}],"height":300,"data":{"url":"assignments.hw2.q2_files\/0.csv","format":{"type":"csv"}}});</script></div>
<p>The barplot shows the regressor coefficients, which are proportional to the feature importances. The plot is generated using the Hanami plotting library.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb33"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(answer</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a> (<span class="kw">str</span> <span class="st">"Feature importances:</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>      (clojure.string/join <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                           (<span class="kw">for</span> [[feature importance] (<span class="kw">map</span> <span class="kw">vector</span> feature-names feature-importance)]</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                             (<span class="kw">format</span> <span class="st">"%-20s : %.4f ;  "</span> feature importance)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><span style="color: black; font-size: 1.5em;"><strong>Feature importances: ID : -0.0023 ;<br>
crim : -0.0490 ;<br>
zn : 0.0578 ;<br>
indus : 0.0043 ;<br>
chas : 0.3847 ;<br>
nox : -0.0680 ;<br>
rm : 1.3832 ;<br>
age : 0.0129 ;<br>
dis : -0.9845 ;<br>
rad : 0.3697 ;<br>
tax : -0.0167 ;<br>
ptratio : -0.7580 ;<br>
black : 0.0116 ;<br>
lstat : -0.7889 ; </strong></span></p>
</blockquote>
<p>This generates a formatted string output of all feature importances, aligning feature names and their corresponding importance values.</p>
<p>Sort features by absolute importance</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb34"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> sorted-features</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;&gt;</span> (<span class="kw">map</span> <span class="kw">vector</span> feature-names feature-importance)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">sort-by</span> #(Math/abs (<span class="kw">second</span> <span class="va">%</span>)))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>       <span class="kw">reverse</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code sorts the features by the absolute value of their importance (coefficient magnitude) in descending order. This is useful because both large positive and large negative coefficients indicate important features in linear models.</p>
<p>Finally, this code outputs a formatted string of the top 5 most important features based on the absolute value of their coefficients. This provides a quick summary of which features have the largest impact on the model’s predictions.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb35"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(answer</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a> (<span class="kw">str</span> <span class="st">"</span><span class="sc">\n</span><span class="st">Top 5 most important features:</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>      (clojure.string/join <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                           (<span class="kw">for</span> [[feature importance] (<span class="kw">take</span> <span class="dv">5</span> sorted-features)]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                             (<span class="kw">format</span> <span class="st">"%-20s : %.4f ;  "</span> feature (<span class="kw">float</span> importance))))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><span style="color: black; font-size: 1.5em;"><strong> Top 5 most important features: rm : 1.3832 ;<br>
dis : -0.9845 ;<br>
lstat : -0.7889 ;<br>
ptratio : -0.7580 ;<br>
chas : 0.3847 ; </strong></span></p>
</blockquote>
</section>
<section id="explanation-of-feature-importances" class="level3">
<h3 class="anchored" data-anchor-id="explanation-of-feature-importances">Explanation of feature importances:</h3>
<ol type="1">
<li>The most important features are those with the largest absolute coefficient values.</li>
<li>Positive coefficients indicate that an increase in the feature leads to an increase in the predicted house price, while negative coefficients indicate the opposite.</li>
<li>The magnitude of the coefficient represents the feature’s relative importance in predicting the house price.</li>
<li>Features with near-zero coefficients have little impact on the prediction.</li>
</ol>
<p>This analysis helps us understand which factors most strongly influence house prices in the Boston housing dataset.</p>
<div style="background-color:grey;height:2px;width:100%;"></div>
<div></div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./assignments.hw2.q1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Question 1</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./assignments.hw2.q3.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Question 3</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>